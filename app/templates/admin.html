{% extends "base.html" %}
{% block title %}Admin | Reliable Walks{% endblock %}
{% block content %}
<section class="admin-panel">
  <div class="container narrow" id="admin-chat" data-role="admin-chat">
    <div class="admin-grid">
      <article class="admin-card visitor-card" data-role="visitor-insights">
        <header class="card-heading">
          <span class="eyebrow">Visitor Intelligence</span>
          <h2>Website Visitors</h2>
          <p class="card-subtitle">
            Monitor real-time traffic, highlight returning fans, and keep control in a single glance.
          </p>
        </header>
        <div class="visitor-toolbar">
          <div class="visitor-stat">
            <span class="stat-label">Total visitors</span>
            <span class="stat-value" data-role="visitor-total">0</span>
          </div>
          <div class="visitor-stat">
            <span class="stat-label">Returning</span>
            <span class="stat-value" data-role="visitor-returning">0</span>
          </div>
          <div class="visitor-stat">
            <span class="stat-label">Visits logged</span>
            <span class="stat-value" data-role="visitor-total-visits">0</span>
          </div>
          <button type="button" class="button ghost" data-role="visitor-refresh">
            Refresh
          </button>
        </div>
        <div class="visitor-table" role="table">
          <div class="visitor-table__head" role="row">
            <span role="columnheader">Visitor</span>
            <span role="columnheader">Insights</span>
            <span role="columnheader">Timeline</span>
            <span role="columnheader" class="actions-header">Actions</span>
          </div>
          <div class="visitor-table__body" data-role="visitor-table-body"></div>
          <p class="visitor-empty" data-role="visitor-empty">
            Visitor activity will appear here the moment someone lands on the site.
          </p>
        </div>
        <p class="form-feedback" data-role="visitor-feedback"></p>
      </article>
      <article class="admin-card">
        <h2>Chat Mode &amp; Business Context</h2>
        <form id="chat-settings-form" class="settings-form">
          <div class="toggle-row">
            <label class="toggle">
              <input type="checkbox" id="autopilot-toggle" />
              <span class="toggle-track" aria-hidden="true"></span>
              <span class="toggle-label">Autopilot</span>
            </label>
            <p class="toggle-description" data-role="mode-description">
              Visitors chat with the AI assistant.
            </p>
          </div>
          <label class="field-label" for="business-context">Business Knowledge</label>
          <p class="field-help">
            Add bullet points, FAQs, pricing, or any notes you want the AI to use in
            its replies.
          </p>
          <textarea
            id="business-context"
            rows="8"
            placeholder="Opening hours, pricing, service areas, booking steps, etc."
          ></textarea>
          <div class="form-actions">
            <button type="submit" class="button primary">Save Settings</button>
            <p class="form-feedback" data-role="settings-feedback"></p>
          </div>
        </form>
      </article>
      <article class="admin-card">
        <h2>Live Conversations</h2>
        <div class="conversation-layout">
          <aside
            class="visitor-list"
            data-role="visitor-list"
            aria-label="Visitor conversations"
          ></aside>
          <div class="conversation-panel">
            <header class="chat-header">
              <div>
                <h3 class="visitor-heading" data-role="visitor-heading">
                  No active visitors
                </h3>
                <span class="visitor-status-tag" data-role="visitor-status"></span>
              </div>
            </header>
            <div class="chat-window" data-chat-messages aria-live="polite"></div>
            <p class="chat-hint" data-role="chat-hint">
              Autopilot is active. Disable it to respond manually.
            </p>
            <form id="agent-reply-form" class="reply-form">
              <label class="field-label" for="agent-message">Reply to visitor</label>
              <textarea
                id="agent-message"
                rows="4"
                placeholder="Type your message to the visitor..."
                required
              ></textarea>
              <div class="form-actions">
                <button type="submit" class="button secondary">Send Reply</button>
                <p class="form-feedback" data-role="agent-feedback"></p>
              </div>
            </form>
          </div>
        </div>
      </article>
      <article class="admin-card access-card" data-role="ban-manager">
        <div class="card-heading">
          <h2>Visitor Access Control</h2>
          <p>
            Instantly block disruptive visitors, keep tabs on every restriction, and
            restore access whenever youâ€™re ready.
          </p>
        </div>
        <form id="ban-visitor-form" class="ban-form">
          <div class="ban-form-grid">
            <label class="field-label" for="ban-identifier">Visitor identifier</label>
            <input
              id="ban-identifier"
              name="identifier"
              type="text"
              placeholder="IP address, email, or reference"
              autocomplete="off"
              required
            />
            <label class="field-label" for="ban-reason">Reason (optional)</label>
            <input
              id="ban-reason"
              name="reason"
              type="text"
              placeholder="Spam messages, abusive language, etc."
              autocomplete="off"
            />
            <button type="submit" class="button danger">Ban visitor</button>
          </div>
          <p class="form-feedback" data-role="ban-feedback"></p>
        </form>
        <div class="ban-list">
          <div class="ban-list-header">
            <h3>Restricted visitors</h3>
            <span class="status-pill" data-role="ban-count">0</span>
          </div>
          <p class="ban-empty" data-role="ban-empty">
            No visitors are currently banned.
          </p>
          <div class="table-wrapper">
            <table class="ban-table" data-role="ban-table">
              <thead>
                <tr>
                  <th scope="col">Visitor</th>
                  <th scope="col">Status</th>
                  <th scope="col">Reason</th>
                  <th scope="col">Added</th>
                  <th scope="col" class="actions">Actions</th>
                </tr>
              </thead>
              <tbody data-role="ban-table-body"></tbody>
            </table>
          </div>
        </div>
      </article>
    </div>
  </div>
</section>
{% endblock %}
